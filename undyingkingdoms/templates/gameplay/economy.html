{% extends "gameplay/layout.html" %}
{% block content2 %}

{% set user = current_user %}
{% set county = current_user.county %}
{% set kingdom = county.kingdom %}

<br><h1 style="text-align:center;">Economy</h1><br><br>

<form method="POST" accept-charset="UTF-8" role="form">
    {{ form.csrf_token }}
    <h2>Resources</h2>
    <table class="production_table">
        <tr>
            <th>Topic</th>
            <th>Current</th>
            <th>Projected Change</th>
            <th style="width:175px;">Modifiers</th>
            <th style="width:175px;">Projected Growth</th>
            <th style="width:175px;">Projected Losses</th>
            <th>Notes</th>
        </tr>
        <br>
        <tr>
            <td>Population</td>
            <td>{{ county.population }}</td>
            {% set population_projection = county.get_population_change(prediction=True) %}
            {% if population_projection >= 0 %}
            <td style="color:green;">+
                {% else %}
            <td style="color:red;">
                {% endif %}
                {{ population_projection }} <img class="resource_icons" src="/static/images/population_icon.jpg">
            </td>
            <td>{% if county.race == 'Elf' %}Elders: -10%{% else %}-{% endif %}</td>
            <td>
                <ul>
                    <li>Births: {{ county.get_birth_rate() }}</li>
                    <li>Immigration: {{ county.get_immigration_rate() }}</li>
                </ul>
            </td>
            <td>
                <ul>
                    <li>Deaths: {{ county.get_death_rate() }}</li>
                    <li>Emigration: {{ county.get_emigration_rate() }}</li>
                </ul>
            </td>
            <td>Raise happiness to lower the amount of emigrants leaving your county.</td>
        </tr>
        <tr>
            <td>Gold</td>
            <td>{{ county.gold }}</td>
            {% if county.get_gold_change() >= 0 %}
            <td style="color:green;">
                +{{ county.get_gold_change() }}
                {% else %}
             <td style="color:red;">
                {{ county.get_gold_change() }}
            {% endif %}
                <img class="resource_icons" src="/static/images/gold_icon.jpg">
            </td>
            <td>Tax Rate: {{ form.tax }}%</td>
            <td>
                <ul>
                    <li>Taxes: {{ county.get_tax_income() }}</li>
                    <li>Excess Production: {{ county.production // 3 }}</li>
                </ul>
            </td>
            <td>Military Expenses: {{ county.get_upkeep_costs() }}</td>
            {% if county.tax < 7 %}
            <td style="color:green;">Your current tax rate has a positive
                {% elif county.tax == 7 %}
            <td style="color:black;">Your current tax rate has no
                {% else %}
            <td style="color:red;">Your current tax rate has a negative
                {% endif %}effect on happiness
            </td>
        </tr>
        <tr>
            <td>Food</td>
            <td>{{ county.grain_stores }}</td>
            {% if county.grain_storage_change() >= 0 %}
            <td style="color:green;">+
                {% else %}
            <td style="color:red;">
                {% endif %}
                {{ county.grain_storage_change() }} <img class="resource_icons" src="/static/images/grain_icon.jpg">
            </td>
            <td>Rations: {{ form.rations }}</td>
            <td>
                <ul>
                    <li>+ {{ county.get_produced_grain() }} <img class="resource_icons" src="/static/images/grain_icon.jpg"></li>
                    <li>+ {{ county.get_produced_dairy() }} <img class="resource_icons" src="/static/images/dairy_icon.jpg"></li>
                </ul>
            </td>
            <td>Food to be Eaten: {{ county.get_food_to_be_eaten() }}</td>
            <td>Excess dairy can not be stored in your graneries. If you do not have enough food, your populace will begin to starve.</td>
        </tr>
        <tr>
            <td>Lumber</td>
            <td>{{ county.wood }}</td>
            {% if county.get_wood_income() >= 0 %}
            <td style="color:green;">+
                {% else %}
            <td style="color:red;">
                {% endif %}
                {{ county.get_wood_income() }} <img class="resource_icons" src="/static/images/wood_icon.jpg">
            </td>
            <td>-</td>
            <td>+ {{ county.get_wood_income() }} from {{ county.buildings['mills'].class_name }}</td>
            <td>-</td>
            <td>Lumber is used to build buildings and to equip certain soldiers.</td>
        </tr>
        <tr>
            <td>Iron</td>
            <td>{{ county.iron }}</td>
            {% if county.get_iron_income() >= 0 %}
            <td style="color:green;">+
                {% else %}
            <td style="color:red;">
                {% endif %}
                {{ county.get_iron_income() }} <img class="resource_icons" src="/static/images/iron_icon.jpg">
            </td>
            <td>-</td>
            <td>+ {{ county.get_iron_income() }} from {{ county.buildings['mines'].class_name }}</td>
            <td>-</td>
            <td>Iron is used to equip powerful soldiers.</td>
        </tr>
        <tr>
            <td>Happiness</td>
            <td>{{ county.happiness }}%</td>
            {% if county.get_happiness_change() >= 0 %}
            <td style="color:green;">+
                {% else %}
            <td style="color:red;">
                {% endif %}
                {{ county.get_happiness_change() }} <img class="resource_icons" src="/static/images/heart_icon.jpg">
            </td>
            <td>-</td>
            <td>+7 baseline</td>
            <td>-{{ county.tax }} from taxes</td>
            <td>Happiness affects emigration rate.</td>
        </tr>
        <tr>
            <td>Hunger</td>
            <td>{{ county.hunger }}%</td>
            {% if county.get_hunger_change() >= 0 %}
            <td style="color:green;">+
                {% else %}
            <td style="color:red;">
                {% endif %}
                {{ county.get_hunger_change() }}
            </td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td>Hunger affects your death rate. Your hunger worsens by 1 for every 200 unfed people.</td>
        </tr>
    </table>
    <br>
    <button type="submit">Update</button>
    <br>
</form>

{% endblock %}
