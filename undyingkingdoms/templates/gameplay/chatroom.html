{% extends "gameplay/layout.html" %}
{% block content2 %}

{% set user = current_user %}
{% set county = current_user.county %}
{% set kingdom = county.kingdom %}
<h1>Discussion</h1>
<div style="border:solid 1px;width:auto;min-height:300px;margin-left:250px;margin-right:250px;">
<ul>
{% for message in chat %}
    <li>{{ message[0] }}  {{ message[1] }}: {{ message[2] }}</li>
{% endfor %}
</ul>
</div>
<br>
<form method="POST" accept-charset="UTF-8" role="form">
    {{ form.csrf_token }}
    {{ render_field(form.message, placeholder="Public to your kingdom", autofocus="") }}
    <br><br>
    <button id="send" type="submit">Say</button>
</form>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
<!--var email = $('#emailinput').val();-->
<!--var variable = $('#variablesinput').val();-->
<!--alert(email + variable);-->
$("form").submit(function(e) {
  e.preventDefault();

  $.ajaxSetup({
    headers: { 'X-CSRF-TOKEN': $("#csrf_token").val() }
  });

  $.post("{{ url_for('chatroom_api') }}",
    {
      message: $("#message").val()
    },
    function(data, status) {
      console.log(data);
      alert("Data: " + data + "\nStatus: " + status);
    }
  );
});
</script>
{% endblock %}
